%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Conclusions\label{ch:conclusions}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% The conclusions of the stated objectives...

The main conclusions are presented in this section with respect to the main objective of this thesis:
% Objective: 
\begin{tcolorbox}[sharp corners,title=Objective]
\objective
\end{tcolorbox}
\vspace{0.3cm}
\noindent The conclusions are categorized by the goals that comprise this objective.

% RO1
\begin{tcolorbox}[sharp corners,title=RO1]
Establish roll motion and manoeuvring model structures that are very similar to the true model.
\end{tcolorbox}
In Paper \ref{pap:rolldamping} it was attempted to establish a physics-informed model for ship roll motion by combining a semi-empirical deterministic roll damping model with a data-driven model identified on a large number of roll decay tests. However, this was a failed attempt, mainly because most of the investigated ships were outside the limits of the semi-empirical model used.  

Using potential flow calculations as the physics-informed part together with semi-empirical formulas for the viscous parts of the roll damping was shown in Paper \ref{pap:ikeda} to be a very efficient way to accurately predict the ship roll motion.

A thorough investigation with VCT and FRMTs inverse dynamics in Paper \ref{pap:vct} showed that the used simulation model could well describe the hull and rudder forces as well as the ship dynamics for a ship with large rudder such as the Optiwise test case where the exclusion of wave generation and the use of only three degrees of freedom were valid assumptions. 

% RO2
\begin{tcolorbox}[sharp corners,title=RO2]
Develop system identification of roll motion and ship manoeuvring from FRMTs.
\end{tcolorbox}
Two different parameter identification techniques were attempted in Paper \ref{pap:rolldamping} to identify the damping terms, where the so called ''derivation approach'' turned out to be the best. In this approach the differential equations of the models were just treated as a linear regression problem. The identification technique was later referred to as inverse dynamics (ID) regression. A problem with ID is that the whole state of the system must be known; In this case the roll angle including its first and second time derivatives ($\theta,\dot{\theta},\ddot{\theta}$ ) must be known, which is often not the case for model test or ship operational data. Instead, velocity and acceleration needs to be estimated by numerical differentiation or other method.

% RO3
\begin{tcolorbox}[sharp corners,title=RO3]
Develop a method to analyse identified models with FRMTs.
\end{tcolorbox}
The method to use inverse dynamics in combination with the state VCTs was in Paper \ref{pap:vct} found to be a useful tool to test the identified models and see if errors origin from the model structure or are inherent in the VCT data. It was for instance shown that the state VCT did not agree well with the wPCC inverse dynamics forces, which indicates that there was something missing in the wPCC VCT data. This could, for instance, be the lack of wave generation or heeled cases in the VCT data, which might be too much of a simplification for the wPCC. For Optiwise on the other hand, which was run at much lower Froude number and little heel, the state VCT agreed much better with the inverse dynamics forces and better agreement was obtained in the closed loop simulations.

% RO4
\begin{tcolorbox}[sharp corners,title=RO4]
Mitigate the system identification multicollinearity.
\end{tcolorbox}
Multicollinearity (see \autoref{sec:multicollinearity}) was a significant problem for system identification in Paper \ref{pap:pit} when a complete Abkowitz model was used on data from IMO standard maneuvers. Consequently, some of the regressed hydrodynamic derivatives had unphysically large values and substantial uncertainties in the regressed polynomials with sums of large counteracting coefficients. However, the models were still mathematically correct, where the regressed polynomials fitted the training data well. The model worked as long as the states were similar to the training data. However, when extrapolating, it is easy to imagine that the balance between these massive derivatives could be disturbed, giving significant extrapolation errors very quickly.

However, multicollinearity is not necessarily a sign that the model structure is wrong, it is rather a sign that the data used do not follow the aspect of persistence of excitation. This means that the structure of the model could be correct, but the data used for identification do not contain enough information to identify all parameters correctly.

Reducing the number of hydrodynamic derivatives, to obtain a more identifiable model structure, is one way to mitigate the multicollinearity that was successfully employed in Paper \ref{pap:pit}. Minimizing the number of derivatives is often a good idea to avoid overfitting irrelevant data, following the prejudice approach that ''Nature is simple'' \cite{ljung_perspectives_2010}. However, this could also lead to model structures with limited applicability, as certain regression terms may only become significant in special conditions like sailing in wind \cite{abkowitz_measurement_1980}.

Using more informative data for the system identification is a better way to handle multicollinearity. Instead of using data from zigzag tests, more informative manoeuvres can be employed such as the optimized pseudo-random binary sequences \cite{yoon_identification_2003,wang_optimal_2020}. This was however outside the scope of this present thesis.

More informative data can however also be ................

Introducing a semi-empirical rudder model seems to have guided the identification toward a more physically correct model, with lower multicollinearity and better generalization from calm water zigzag tests to wind conditions.

The semi-empirical rudder seems to have helped in reducing the multicollinearity between the hull and rudder, but the multicollinearity between the drift ang yaw rate remain when the zigzag test data is used, which may explain why the PI model did not find perfect agreement with the Reference model. Addressing this part of the multicollinearity problem is more related to test design â€“ to get data with better [[persistence of excitation]] such as the [[optimized pseudo-random binary sequences|PRBS]] or using CMT or VCT.