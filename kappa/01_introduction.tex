%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Introduction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%________________________________________
This Chapter begins with an introduction to the thesis, providing a brief overview of the background, and a discussion of current knowledge gaps, objectives, and limitations. The outline of the thesis is also presented at the end of this chapter.

\section{Background}
Already before knowing it we as as human beings start to form models to understand our surroundings. For a small child, the parents may for instance act as role models. A model could also be a smaller physical copy of an object, like a model airplane or ship. A more scientific representation of a model will be investigated in this thesis as a simplified description of a system or process to assist in calculations and predictions for ship dynamics.
\textcite{ljung_modeling_2021} describes a model as a tool we use to answer questions about the system without having to do an experiment. This ability can be used in many ship applications:
\vspace{0.3cm}
\begin{itemize}
    \item We can build a virtual prototype model to assess the performance before the ship has been built.
    \item We can also build digital twin models for the existing ship to conduct experiments that might be too expensive or too dangerous to perform with the real ship.
\end{itemize}
\vspace{0.3cm}
The ship itself can be thought of as the true model $\mathbf{S}$ which is impossible to fully describe mathematically. We can however make observations of the true model, by making measurements $y$ onboard the ship with some measurement error $\epsilon$:
$$
y = \mathbf{S} + \epsilon
$$
We want to create a model $\mathbf{m}$ that approximates the ship $\mathbf{S}$. There will be a difference between the model and the true model called process noise $w$:
$$
\mathbf{S} = \mathbf{m} + w
$$
which can be thought of as the error caused by the simplifying assumptions in the model. E.g., when approximating a non-linear function with a linear model.
Finding the true model of the ship system is an unreachable goal, which is also an undesirable goal since we don't want to model everything about the ship, just the things relevant for the question at hand. The model $\mathbf{m}$ can be a mathematical model, but it could also be a scale model of the ship to be used in towing tanks experiments.

It is very hard to fully assess if $\mathbf{m}$ is a good approximation of the true model $\mathbf{S}$, since the difference between measurement data and predicted data contains both process noise and measurement noise.
$$
y - \mathbf{m} = w + \epsilon
$$
In this thesis, we will explore ways to find an approximate mathematical model of some aspects of the ship dynamics. The models can be categorized as white-, black-, or gray-boxes. 
\vspace{5pt}
\begin{itemize}
    \setlength\itemsep{5pt}
    \item White-box modeling \\
    involves applying physical principles to ensure that no observed data is required. One example is computational fluid dynamics (CFD). Semi-empirical models, in which unknown physical constants have been derived from historical experiments, could also be considered white-box models \cite{leifsson_grey-box_2008}.  

    \item Black-box modeling \\
    means that parameters do not have physical significance and that the objective is to find an effective model that fits the observed data \cite{lindskog_tools_1995}.
    
    \item Grey-box modeling \\
    is using a combination of white-box and black-box modeling methods to ensure that both a physical model and data are used. This concept is also referred to as semi-physical modeling, hybrid modeling, or semi-mechanistic modeling in the literature \cite{leifssonGreyboxModelingOcean2008}. 
\end{itemize}
\vspace{5pt}
The fundamental way of system identification is to conduct experiments and then make observations to find a mathematical model. 
The observations could also be from the regular operation with the ship, in natural experiments where the conditions are determined by nature or other factors outside the control of the researchers.

%\section{Old}
%%Section comments: Be mindful of using objective language. Avoid using general words like "good" or "special." It would also help to explain the example used for the Butterfly effect more.
%The use of twin models is not a new idea. NASA built twin rockets for the Apollo missions, where one rocket went to the Moon and the other twin rocket stayed on Earth.
%The twin model could have been used as a reference object in case of a mishap during the mission.  
%The twin model concept has many other useful applications, not just for catastrophic scenarios with a failing space ship, but also for more ordinary applications for conventional ships. However, building a real twin ship as a reference object is not realistic. Instead, with data recorded aboard ships, it is possible to build a ship digital twin (SDT) to serve the same purpose.
%System identification methods of rigid body ship dynamics are presented in this thesis, which can be used to build important sub-components/models in the SDTs. 
%
%Ship dynamics is a branch of ship hydrodynamics that concerns the ship's forces and motions when the ship is allowed to move and rotate in all directions. Seakeeping and Manoeuvring are the two major subfields (see \autoref{fig:seakeeping_and_manoeuvring}). Seakeeping studies the  behavior of a ship in a seaway while it is under the influence of external waves, currents, and wind. Calm water conditions, lacking the external waves, are further assumed in Manoeuvring, which is considered either an idealized and simplified case of Seakeeping or the true conditions in sheltered environments.
%\begin{figure}[h]
%    \centering
%    \begin{subfigure}[b]{0.45\textwidth}
%         \centering
%         \includegraphics[width=\textwidth]{kappa/images/seakeeping.jpg}
%         \caption{Seakeeping.}
%         \label{fig:seakeeping}
%     \end{subfigure}
%     \hfill
%     \begin{subfigure}[b]{0.45\textwidth}
%         \centering
%         \includegraphics[width=\textwidth]{kappa/images/manoeuvring.jpg}
%         \caption{Manoeuvring.}
%         \label{fig:manoeuvring}
%     \end{subfigure}
%     \hfill
%    \caption{Seakeeping and manoeuvring model tests, copyright SSPA.}
%    \label{fig:seakeeping_and_manoeuvring}
%\end{figure}
%This chapter first provides a background by defining the Internet of Ships (IoS), ship digital twins (SDT) and the modelling of rigid body ship dynamics with white-box, black-box, or grey-box models. A literature review of system identification is then presented.
%The motivation and objective of this research are then stated, followed by the assumptions and limitations.

%\section{Background}
%With the principles of the Industry 4.0, Shipbuilding 4.0 will transform the design, manufacturing, operation, shipping, services, production systems, maintenance, and value chains in all aspects of the shipbuilding 
%industry \cite{stanic_toward_2018}.
%The emergence of the Internet-of-Things (IoT) has led to the introduction of the Internet of Ships (IoS) paradigm \cite{liu_internet_2016-1}. 
%\begin{quote} 
%\vspace{0.1cm}
%\say{IoS is the interconnecting of sensing objects, such as ships, crews, cargoes, onboard equipment, the waterway environment, waterway facilities, shore-based facilities, and other navigation elements. The sensing objects are embedded with various sensor and heterogeneous network technologies that enable them to collect and exchange data.} 
%\vspace{0.1cm}
%\end{quote}
%Safety enhancements, route planning and optimization, energy efficiency, automatic berthing and autonomous shipping are some of the emerging applications of the IoS \cite{aslam_internet_2020}.
%A ship digital twin (SDT), which is a digital copy of a real ship, is one way to utilize all data within the IoS \cite{chen_review_2021}. 
%SDTs are data-driven in contrast to the alternative model-based virtual prototyping (VP) \cite{major_framework_2021}. An SDT is typically used as a model for an existing ship from which data can be collected; the VPs are  prototypes for future ships, in which no operational data is available.
%The models for VP and SDT are categorized as white-box, black-box, or grey-box models.White-box models are used in VP. Either black-box or grey-box models are used in the SDTs. 
%\vspace{5pt}
%\begin{itemize}
%    \setlength\itemsep{5pt}
%    \item White-box modeling \\
%    involves applying physical principles to ensure that no observed data is required. One example is computational fluid dynamics (CFD). Semi-empirical models, in which unknown physical constants have been derived from historical experiments, could also be considered white-box models \cite{leifsson_grey-box_2008}.  
%
%    \item Black-box modeling \\
%    means that parameters do not have physical significance and that the objective is to find an effective model that fits the observed data \cite{lindskog_tools_1995}.
%    
%    \item Grey-box modeling \\
%    is using a combination of white-box and black-box modeling methods to ensure that both a physical model and data are used. This concept is also referred to as semi-physical modeling, hybrid modeling, or semi-mechanistic modeling in the literature \cite{leifsson_grey-box_2008}. 
%\end{itemize}
%\vspace{5pt}
%
%\noindent The white and black component can be combined as a grey box model in several ways, using either a serial or parallel approach \cite{leifsson_grey-box_2008} as seen in \autoref{fig:greycombinations}. 
%
%\input{kappa/fig_grey_combinations}

\input{kappa/literature_review}
\input{kappa/terminology}



%"Critic" to what has been done before
\section{Motivation and objective}
\label{sec:motivation}
% Motivation:
\textcolor{red}{Knowledge gap? ...leading to the objectives}


A profuse amount of data concerning the operation of ships in the oceans is collected daily. Many uses and potential applications of this data remains to be discovered. The use of SDTs (which are modelled as white-boxes, black-boxes, or grey-boxes) has potential .
Black-box modeling is entirely data-driven, which means that no prior understanding of the system generating the data is needed. Therefore, it is an attractive option for the SDT modelling. One caveat is that the black-box modeling may provide infeasible models outside of the domain covered by the available data \cite{nielsen_machine_2022}. 

The white-box modeling, which is not relying on the data, does not have this problem. However, to obtain high accuracy it does require a complete understanding of the system. Acquiring such knowledge may be possible for some cases with CFD calculations, but it is not practical for the complex environment and nonlinearities of a ship operating at sea \cite{miller_ship_2021}. 
Wind, waves, and currents add uncertainty to the modelling in the deep sea. Water depth and the bank effect add uncertainty in coastal areas \cite{nielsen_machine_2022}. 
Even if the sea is flawlessly modelled, long-term predictions with high accuracy will be exposed to deterministic chaos \cite{lorenz_deterministic_1963}, which is popularly known as the butterfly effect. During the butterfly effect, only a very small difference in the initial conditions results in a significantly different outcome. For instance, a period of two weeks is believed to be the upper limit for weather forecasts  \cite{zhang_what_2019}. Because the methods developed in this thesis frame the first step towards system identification in full scale sea conditions, grey-box modelling is used. The grey-box model involves merging the white-box and black-box methods in an attempt to alleviate concerns regarding both models. 

It is practical to first assume higher levels of simplifications and approximations for the problem under study and thereafter increase the complexity of the problem step by step. The effects of various factors can be initially studied in isolation with this approach. 
Rigid body ship dynamics at full scale sea conditions comprises uncertainties from:
\vspace{5pt}
\begin{itemize}
    \setlength\itemsep{5pt}
    \item the \textbf{environment}: wind, waves, and currents
    \item the \textbf{ship}: geometry and mass properties
    \item the \textbf{measurements}
\end{itemize}
\vspace{5pt}

\noindent The simplification this thesis presents is limiting the uncertainties at full scale sea conditions by using model test data from a controlled laboratory environment. 

Simplifying 

The objective of this thesis is given in the following:
% Objective: 
% Objectives --> Conclusions!
% Objective + in order to...
\vspace{0.2cm}
\begin{tcolorbox}[sharp corners,title=Objective]
    \emph{\objective}
    \tcblower
\end{tcolorbox}
\vspace{0.3cm}

This objective has been been broken down into the following goals:
\begin{tcolorbox}[sharp corners,title=Goal A]
    \emph{Establish model structures for the rigid body ship dynamics in calm water that are similar to the true ship and obeys the law of physics.}
    \tcblower
\end{tcolorbox}

\begin{tcolorbox}[sharp corners,title=Goal B]
    \emph{Develop methods for parameter identification of the model structures from FRMTs or VCT.}
    \tcblower
    As a simplification, parameter identification on model structures for roll motion (with one single degree of freedom) is initially developed.
    
    The developed parameter identification is then applied on the three degree of freedom manoeuvring model structures. 
\end{tcolorbox}

\begin{tcolorbox}[sharp corners,title=Goal C]
    \emph{Analyse the identified models with FRMTs inverse dynamics.}
    \tcblower
\end{tcolorbox}

\begin{tcolorbox}[sharp corners,title=Goal D]
    \emph{Mitigate multicollinearity in the identified models.}
    \tcblower
\end{tcolorbox}

%\begin{tabular}{p{10cm}}
%\centering
%\begin{enumerate}
%    \item Establish roll motion and manoeuvring model structures that are very similar to the true model.
%    \vspace{0.2cm}
%    \item Develop system identification of roll motion and ship manoeuvring from FRMTs.
%    \vspace{0.2cm}
%    \item Develop a method to analyse identified models with FRMTs.
%    \vspace{0.2cm}
%    \item Mitigate the system identification multicollinearity.
%\end{enumerate}
%\end{tabular}
%
%\begin{tcolorbox}[sharp corners,title=RO1]
%Establish roll motion and manoeuvring model structures that are very similar to the true model.
%\end{tcolorbox}
%\begin{tcolorbox}[sharp corners,title=RO2]
%Develop system identification of roll motion and ship manoeuvring from FRMTs.
%\end{tcolorbox}
%\begin{tcolorbox}[sharp corners,title=RO3]
%Develop a method to analyse identified models with FRMTs.
%\end{tcolorbox}
%\begin{tcolorbox}[sharp corners,title=RO4]
%Mitigate the system identification multicollinearity.
%\end{tcolorbox}

%\subsubsection*{\normalfont \color{black} \textbf{Roll motion model}}
%The first goal of the thesis is to develop a model for the calm water rigid body ship dynamics in the roll degree of freedom; it is based on model test data.
%
%\subsubsection*{\normalfont \color{black} \textbf{Manoeuvring model}}
%The second goal is to increase the complexity and uncertainty of the modelling by adding the surge, sway, and yaw degrees of freedom, which addresses the manoeuvring problem.
%
%\subsubsection*{\normalfont \color{black} \textbf{Model generalization}}
%The third goal is a constraint. In order to be of practical use in the internet of ships (IoS) applications, the models must be able to make predictions outside of the domain covered by the available data.
%
\section{Assumptions and limitations}

% Assumptions --> Future work
%Calm waters...
The calm water condition is used as a simplification of the real sea condition that a ship encounters. This condition does not account for the factors of wind, waves, and currents. These assumptions simplify the system identification by reducing the degrees of freedom to: surge, sway, yaw and, roll. 
The rigid body assumption simplifies the ship to a stiff body that does not transform under the influence of forces. 
It is important to note that all results are not necessarily directly transferable to the full scale when model scale data is used considering potential scale effects. 

\section{Reproducibility}
The research for this thesis has been conducted with the aim of having a high degree of reproducibility. The U.S. National Science Foundation (NSF) subcommittee on replicability in science defines reproducibility as \entryneedsurl{bollen_social_2015}\cite{bollen_social_2015}:
\begin{quote}
\vspace{0.2cm}
\say{Reproducibility refers to the ability of a researcher to duplicate the results of a prior study using the same materials and procedures as were used by the original investigator. ...  Reproducibility is a minimum necessary condition for a finding to be believable and informative.}
\vspace{0.2cm}
\end{quote}
To ensure adequate reproducibility, all code developed in this research has been made available as open source. In addition, the used data has been published as open data, as seen in the references in \autoref{tab:reproducibility}. Publishing the roll decay data from Paper \ref{pap:rolldamping} as open data was not possible due to intellectual property (IP) rights.

\begin{table}[H]
    \centering
    \caption{References for reproducibility.}
    \label{tab:reproducibility}
    \begin{tabular}{ c l l}
        \toprule
         Paper &  Code & Data \\
         \hline
         \ref{pap:rolldamping} & \textcite{alexandersson_rolldecay-estimators_2022} & Unpublished due to IP rights\\
         \ref{pap:pit} & \textcite{alexandersson_code_2022} & \textcite{alexandersson_wpcc_2022}, \textcite{stern_experience_2011} \\
         \bottomrule
    \end{tabular}
\end{table}

\section{Outline of the thesis}
Chapter \ref{ch:models} presents the models for rigid body ship dynamics used in this thesis. The models for roll motion are introduced in \autoref{sec:roll}, and the manoeuvring motion models are introduced in  \autoref{sec:manoeuvring model}. These models represent the physical principles and thereby the white-box component of the developed grey-box models.
Parameter estimations, representing the black-box component, are used to regress the parameters of the white-box models. The parameter estimations are introduced in \autoref{ch:methods} for the roll motion and the manoeuvring motion in \autoref{sec:_roll} and \autoref{sec:_VMM}. 
A summary of the appended papers, which includes research activities and a selection of the most relevant results, is presented in \autoref{ch:results}, followed by the conclusions in \autoref{ch:conclusions} and plans for future work in \autoref{ch:future_work}.