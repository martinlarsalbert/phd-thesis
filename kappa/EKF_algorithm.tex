\label{04.01_EK:ek-algorithm} 
\noindent\begin{sphinxadmonition}{note}{Algorithm 3.1 (Discrete\sphinxhyphen{}time extended Kalman filter)} \\
\sphinxstylestrong{Inputs} \\
\hspace*{0.5cm} Initial values: \(\mathbf{x_0}\), \(\mathbf{P_0}\) \\
\hspace*{0.5cm} Filter parameters: \(\mathbf{C_d}\), \(\mathbf{R_d}\), \(\mathbf{Q_d}\), \(\mathbf{E_d}\) \\
\hspace*{0.5cm} Data: \(\mathbf{y}\), \(\mathbf{c}\) \\
\sphinxstylestrong{Output} \\
\hspace*{0.5cm} Estimated states: \(\mathbf{\hat{x}}\), estimated state covariances \(\mathbf{\hat{P}}\)
\vspace{0.2cm}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
Initial values:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} 

\(\mathbf{\hat{x}}[0] = \mathbf{x_0}\)

\item {} 

\(\mathbf{\hat{P}}[0] = \mathbf{P_0}\)

\end{enumerate}

\item {} 

For \(k\) in \(n\) measurements (time steps)
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{.}%
\item {} 

KF gain
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumiii}{enumiv}{}{.}%
\item {} 

\(\mathbf{K}[k]=\mathbf{\hat{P}}[k] \mathbf{C_d}^T \left(\mathbf{C_d} \mathbf{\hat{P}}[k] \mathbf{C_d}^T + \mathbf{R_d}\right)^{-1}\)

\item {} 

\(\mathbf{I_{KC}} = \mathbf{I_n} - \mathbf{K}[k] \mathbf{C_d}\)

\end{enumerate}

\item {} 

Update
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumiii}{enumiv}{}{.}%
\item {} 

State corrector
\(\mathbf{\hat{x}}[k] = \mathbf{\hat{x}}[k] + \mathbf{K}[k] (\mathbf{y} - \mathbf{C_d} \mathbf{\hat{x}}[k]) \)

\item {} 

Covariance corrector
\(\mathbf{\hat{P}}[k] = \mathbf{I_{KC}} \cdot \mathbf{\hat{P}}[k] \mathbf{I_{KC}}^T + \mathbf{K}[k] \mathbf{R_d} \mathbf{K}^T \)

\end{enumerate}

\item {} 

Predict
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumiii}{enumiv}{}{.}%
\item {} 

State predictor
\(\mathbf{\hat{x}}[k+1] = \mathbf{\hat{x}}[k] + h \cdot \mathbf{\hat{f}}(\mathbf{\hat{x}}[k], \mathbf{c}[k])\)

\item {} 

Covariance predictor
\(\mathbf{\hat{P}}[k+1] = \mathbf{A_d}[k]  \mathbf{\hat{P}}[k] \mathbf{A_d}[k]^T + \mathbf{E_d} \mathbf{Q_d} \mathbf{E_d}^T \)

\end{enumerate}

\end{enumerate}

\end{enumerate}
\end{sphinxadmonition}